---
title: S3-Compatible Object Storage Configuration
description: Learn how to configure any S3-compatible object storage (MinIO, Wasabi, Backblaze B2, DigitalOcean Spaces, Cloudflare R2, etc.) for Appcircle Server using the Helm chart
sidebar_position: 40
tags:
  [self-hosted, object-storage]
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import NeedHelp from '@site/docs/\_need-help.mdx';

## Overview

This guide provides comprehensive instructions for configuring **any S3-compatible object storage** (such as MinIO, Wasabi, Backblaze B2, DigitalOcean Spaces, Cloudflare R2, etc.) as your object storage backend for the Appcircle Server.

By default, the Appcircle chart includes an in-cluster MinIO deployment provided by `bitnami/minio`. If you are installing the Appcircle for testing purposes, you may use the built-in MinIO deployment.

For production environments, it is recommended to configure an external MinIO or S3-compatible object storage instance. The recommended MinIO version is `2024-03-15` or later, with a disk size of 1TB.

:::info
The recommended disk size for the MinIO instance may vary depending on your usage requirements. It can range from 100GB to 3-4TB.
:::


### What This Guide Covers

This guide will walk you through the process of configuring an S3-compatible object storage backend for the Appcircle Server Helm chart. To use an S3-compatible provider with Appcircle Server, you need to:

- **Set up your object storage provider**: Buckets, users, and permissions
- **CORS setup**: For direct browser uploads/downloads
- **Configure Appcircle Server**: Update Helm values to use your S3-compatible storage

:::info
This guide is for any S3-compatible provider. For [AWS S3](/self-hosted-appcircle/install-server/helm-chart/configuration/production-readiness/aws-s3-configuration) or [GCP Cloud Storage](/self-hosted-appcircle/install-server/helm-chart/configuration/production-readiness/gcp-cloud-storage-configuration), see their dedicated guides.
:::

## Prerequisites

To complete this guide, you must have the following:

- An S3-compatible object storage provider (MinIO, Wasabi, Backblaze B2, DigitalOcean Spaces, Cloudflare R2, etc.)
- Access to the provider's management console or CLI
- The Helm chart [installed](https://helm.sh/docs/intro/install/) and [configured](https://helm.sh/docs/intro/quickstart/) for your Kubernetes cluster
- Basic understanding of object storage, access keys, and Kubernetes



## Configuration Steps

### 1. Create and Configure Buckets

**Create the required buckets** to store the artifacts generated by the Appcircle Server.

Appcircle Server requires the following buckets for different purposes:

- **`${BUCKET_PREFIX}temp`**: Temporary files and uploads (requires CORS configuration for direct uploads/downloads from the client browsers)
- **`${BUCKET_PREFIX}build`**: Build artifacts and logs
- **`${BUCKET_PREFIX}distribution`**: Testing Distribution files
- **`${BUCKET_PREFIX}storesubmit`**: Appcircle Store Submit files
- **`${BUCKET_PREFIX}store`**: Enterprise App Store files
- **`${BUCKET_PREFIX}agent-cache`**: Appcircle Runner cache files
- **`${BUCKET_PREFIX}backup`**: Backup files
- **`${BUCKET_PREFIX}publish`**: Published mobile app binaries

:::tip
**Bucket Naming**: Choose a unique bucket prefix for your organization or environment (e.g., `appcircle-spacetech-`).
:::

**Create the required buckets** using your S3-compatible provider's management console, CLI, or API. Refer to your provider's documentation for specific instructions on bucket creation.

:::info
You can use your provider's web console, CLI tools, or API to create the buckets. The exact method varies by provider.
:::

### 2. IAM/User Setup and Access Keys

**Create a user (or access key pair) with permissions** to manage objects in the above buckets. The process varies by provider:

- **MinIO**: Use the MinIO Console or `mc admin user add` to create a user and assign policies.
- **Wasabi**: Use the Wasabi Console to create an access key/secret key pair with full access to the relevant buckets.
- **Backblaze B2**: Use the B2 Console to create an application key with access to the required buckets.
- **DigitalOcean Spaces**: Use the DigitalOcean Console to create a Spaces access key with appropriate permissions.
- **Cloudflare R2**: Use the Cloudflare Dashboard to create an API token with R2 permissions.

:::caution
Restrict permissions to only the required buckets for better security.
:::

### 3. CORS Configuration

**Configure CORS settings** for the `temp` bucket to allow cross-origin requests from your Appcircle Server web UI.

- Here is a sample CORS configuration for the `temp` bucket that is compatible with AWS CLI:

:::caution
Make sure to replace the `https://my.appcircle.spacetech.com` with the web UI URL that you will use to access the Appcircle Server. For example, if you are using `.appcircle.spacetech.com` as the domain in the Helm `values.yaml` file, the web UI URL will be `https://my.appcircle.spacetech.com`.
:::

```bash
export CORS='{
  "CORSRules": [
    {
      "AllowedHeaders": ["*"],
      "AllowedMethods": ["GET", "PUT", "POST", "DELETE", "HEAD"],
      "AllowedOrigins": ["https://my.appcircle.spacetech.com"],
      "ExposeHeaders": [],
      "MaxAgeSeconds": 3600
    }
  ]
}'
```

Refer to your provider's documentation for how to apply CORS settings.

:::tip
- The CORS configuration is only required for the `temp` bucket
- **Make sure** that the clients are allowed to access the `temp` bucket over network. The clients (Appcircle users with the web UI) use the `temp` bucket to upload/download files.
- Other buckets don't require CORS configuration as they are accessed server-side
- If you will use the Appcircle Server web UI with HTTP instead of HTTPS, replace `https://` with `http://` in the origin
:::


:::info

If the S3-compatible provider supports CORS configuration with the AWS CLI, you can use the following steps:

- Configure the AWS CLI with your access key, secret key, region, and endpoint URL for the S3-compatible provider.

```bash
export AWS_ACCESS_KEY_ID=<YOUR_ACCESS_KEY>
export AWS_SECRET_ACCESS_KEY=<YOUR_SECRET_KEY>
export AWS_DEFAULT_REGION=<YOUR_REGION>
export AWS_ENDPOINT_URL=<YOUR_S3_ENDPOINT_URL>
```

- Apply the CORS configuration to the `temp` bucket:

```bash
aws s3api put-bucket-cors \
    --endpoint-url $AWS_ENDPOINT_URL \
    --bucket ${BUCKET_PREFIX}temp \
    --cors-configuration "$CORS"
```

- Check the CORS configuration:

```bash
aws s3api get-bucket-cors \
    --endpoint-url $AWS_ENDPOINT_URL \
    --bucket ${BUCKET_PREFIX}temp
```

:::

### 4. Create Kubernetes/OpenShift Secret with Access Keys

<Tabs groupId="Platform">

  <TabItem value="kubernetes" label="Kubernetes">

- Create the namespace that Appcircle Server will be installed in if you haven't yet:

```bash
kubectl create namespace appcircle
```

- **Create a Kubernetes secret** named `<helm-release-name>-minio-connection` with your S3-compatible access and secret keys:

```bash
kubectl create secret generic appcircle-server-minio-connection \
  -n appcircle \
  --from-literal=accessKey=<YOUR_ACCESS_KEY> \
  --from-literal=secretKey=<YOUR_SECRET_KEY>
```

  </TabItem>
  <TabItem value="openshift" label="OpenShift">

- Create the project that Appcircle Server will be installed in if you haven't yet:

```bash
oc new-project appcircle
```

- **Create a OpenShift secret** named `<helm-release-name>-minio-connection` with your S3-compatible access and secret keys:

```bash
oc create secret generic appcircle-server-minio-connection \
  -n appcircle \
  --from-literal=accessKey=<YOUR_ACCESS_KEY> \
  --from-literal=secretKey=<YOUR_SECRET_KEY>
```

  </TabItem>
</Tabs>

:::caution
- Replace `appcircle` with your actual namespace if different.
- Replace `<YOUR_ACCESS_KEY>` and `<YOUR_SECRET_KEY>` with your actual access and secret keys.
- Replace `appcircle-server-minio-connection` with `<helm-release-name>-minio-connection`. Appcircle documentation uses `appcircle-server` as the release name.
:::

### 5. Configure Appcircle Server to Use S3-Compatible Storage

**Configure your `values.yaml` file** to use your S3-compatible object storage.

Add or update the following configuration to your `values.yaml` file:

<Tabs groupId="s3-provider">

  <TabItem value="minio" label="MinIO">

```yaml
global:
  minio:
    url: "https://your-minio-endpoint.com" # e.g., https://minio.spacetech.com:9000
    region: "local" # MinIO uses "local" as the region
    useHttp: "false" # Set to "true" if the MinIO endpoint uses HTTP instead of HTTPS
    bucketPrefix: "appcircle-spacetech-" # Replace with your actual bucket prefix
resource:
  s3:
    clientProvider: "MINIO" # Use "MINIO" for MinIO
minio:
  enabled: false # Disable the internal MinIO server if you are using an external MinIO server
```

  </TabItem>

  <TabItem value="any-s3-compatible-provider" label="Any S3-Compatible Provider">

```yaml
global:
  minio:
    url: "https://your-s3-endpoint.com" # e.g., https://s3.wasabisys.com
    region: "us-east-1" # Use the region of the buckets
    useHttp: "false" # Set to "true" if the S3 endpoint uses HTTP instead of HTTPS
    bucketPrefix: "appcircle-spacetech-"
resource:
  s3:
    clientProvider: "S3" # Use "S3" for generic S3-compatible providers
minio:
  enabled: false # Disable the internal MinIO server if you are using an external MinIO server
```

  </TabItem>

</Tabs>

:::caution
- Set `useHttp` to `true` only if your S3 or MinIO endpoint does not support HTTPS (not recommended for production).
- Check your provider's documentation for the correct endpoint URL and region.
- Replace `appcircle-spacetech-` with your actual bucket prefix.
:::

## Next Steps

After completing the S3-compatible storage configuration:

1. **Return to the main installation guide**:
   - [Installation](/self-hosted-appcircle/install-server/helm-chart/installation)
2. **Continue with the installation process** using your configured `values.yaml` file
3. **Verify the configuration** by checking that Appcircle Server can access the buckets after installation

<NeedHelp /> 